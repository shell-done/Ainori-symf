<?php

namespace BackOfficeBundle\Repository;

/**
 * CovoiturageRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class CovoiturageRepository extends \Doctrine\ORM\EntityRepository {
    public function getCo2SavedOnRegularTrip() {
        $query = $this->createQueryBuilder("covoit")
            ->select("sum(co2.valCo2)")
            ->innerJoin("covoit.co2", "co2")
            ->innerJoin("covoit.trajet", "trajet")
            ->innerJoin("trajet.typeTrajet", "type")
            ->where("type.typeTrajet = 'REG'")
            ->getQuery();

        return $query->getOneOrNullResult()[1];
    }
}
